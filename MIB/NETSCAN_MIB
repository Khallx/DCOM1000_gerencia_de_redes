-- MIB para interface com netscan
-- autores: 
-- Julio Costella Vicenzi
-- Yuri Alves
NETSCAN-MIB DEFINITIONS ::= BEGIN
IMPORTS
	OBJECT-TYPE,
    IpAddress, Counter, Gauge, TimeTicks, NetworkAddress, 
    experimental
		FROM RFC1155-SMI
;

netscan OBJECT IDENTIFIER ::= { experimental 1 }

nsHostIP OBJECT-TYPE
    SYNTAX IpAddress
    ACCESS read-write
    STATUS optional
    DESCRIPTION "Endereco de IP do Host."
::= { netscan 1 }

nsHostMAC OBJECT-TYPE
    SYNTAX OCTET STRING
    ACCESS read-write
    STATUS optional
    DESCRIPTION "Endereco de MAC do Host."
::= { netscan 2 }

nsNetworkMask OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-write
    STATUS optional
    DESCRIPTION "Mascara da rede a ser procurada."
::= { netscan 3 }

nsScanNetwork OBJECT-TYPE
    SYNTAX TimeTicks
    ACCESS read-write
    STATUS mandatory
    DESCRIPTION "Realizar Scan na rede."
    DEFVAL { 1 } -- scan a cada segundo
::= { netscan 4 }

nsSetMac OBJECT-TYPE
    SYNTAX IpAddress
    ACCESS write-only
    STATUS optional
    DESCRIPTION "Atualiza IP atraves do MAC."
::= { netscan 5 }


-- -------------------- --
--     TABLE DEFINE     --
-- -------------------- --

ifNumber OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "Numero de interfaces de rede (indepentende do status)
        presentes no sistema."
::= { netscan 6 }

deviceTable OBJECT-TYPE 
    SYNTAX SEQUENCE OF IfEntry
    ACCESS not-accessible
    STATUS mandatory
    DESCRIPTION "Lista de entradas de interface.
        O numero de entradas e dado pelo valor em ifNumber."
::= { netscan 7 }

ifEntry OBJECT-TYPE 
    SYNTAX IfEntry
    ACCESS not-accessible
    STATUS mandatory
    DESCRIPTION "Uma interface de entrada contem info de uma interface em particular."
INDEX { tblIndex }
::= { deviceTable 1 }
 
IfEntry ::= SEQUENCE {
    tblIndex    INTEGER,
    macAddress  OCTET STRING,
    ipAddress   IpAddress,
    status      INTEGER,
    vendor      OCTET STRING,
    fscanDate   OCTET STRING 
}

tblIndex OBJECT-TYPE
    SYNTAX INTEGER (1..2147483647)
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "Identificador unico de cada interface, varia entre 1 e o valor contido 
        em ifNumber. O valor de cada interface deve parmanecer constante ate o reset 
        do sistema de gerenciamento."         
::= { ifEntry 1 }

macAddress OBJECT-TYPE
    SYNTAX OCTET STRING
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "MAC DA INTEFACE."         
::= { ifEntry 2 }

ipAddress OBJECT-TYPE
    SYNTAX IpAddress
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "IP DA INTEFACE."         
::= { ifEntry 3 }

status OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "STATUS DA INTEFACE."         
::= { ifEntry 4 }

vendor OBJECT-TYPE
    SYNTAX OCTET STRING (SIZE (0..255))
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "Descricao do fabricante"
::= { ifEntry 5 }

fscanDate OBJECT-TYPE
    SYNTAX OCTET STRING (SIZE (0..255))
    ACCESS read-only
    STATUS mandatory
    DESCRIPTION "Data de descobreta"
::= { ifEntry 6 }

END
